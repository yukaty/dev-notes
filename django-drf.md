# Django Rest Framework (DRF)

- [API documentation](#api-documentation)
  - [Swagger UI](#swagger-ui)
  - [1. Setup](#1-setup)
  - [2. Configure URL patterns](#2-configure-url-patterns)
  - [3. Update the `REST_FRAMEWORK`](#3-update-the-rest_framework)
- [Authentication](#authentication)
  - [1. Install Django Rest Framework](#1-install-django-rest-framework)
  - [2. Update `settings.py`](#2-update-settingspy)
  - [3. Migrate the Database](#3-migrate-the-database)
  - [4. Add a URL Pattern for Your View](#4-add-a-url-pattern-for-your-view)
  - [5. Create a View](#5-create-a-view)
  - [6. Test](#6-test)
- [APIView vs Viewsets](#apiview-vs-viewsets)

Django Rest Framework (DRF) is a tool for building RESTful APIs in Django apps.


## API documentation
You can generate API documentation in DRF using `drf-spectacular`.

`drf-spectacular` is an extension for DRF to automatically generate the API schema and inspect it through Swagger UI.

### Swagger UI
Swagger is a suite of API developer tools.

Swagger UI is a tool that utilizes the API schema to test APIs in a browser. You can send requests to actual API endpoints and check their responses while reading the API documentation.
git
### 1. Setup

To add `drf-spectacular` to your project, specify its version in the `requirements.txt` file.

### 2. Configure URL patterns

In `urls.py`, you configure URL patterns for the API schema and Swagger UI documentation.

- `SpectacularAPIView`: This view generates the API schema. Accessing this endpoint returns a document in OpenAPI format.
- `SpectacularSwaggerView`: This view provides a Swagger UI interface using the schema generated by `SpectacularAPIView`.

```python
urlpatterns = [
    path('api/schema/', SpectacularAPIView.as_view(), name='api-schema'),
    path(
        'api/docs/',
        SpectacularSwaggerView.as_view(url_name='api-schema'),
        name='api-docs',
    ),
]
```

### 3. Update the `REST_FRAMEWORK`

Update the `REST_FRAMEWORK` configuration in `settings.py`. This ensures DRF uses `drf-spectacular` to automatically generate the API schema.

```python
REST_FRAMEWORK = {
    'DEFAULT_SCHEMA_CLASS': 'drf_spectacular.openapi.AutoSchema',
}
```

## Authentication

With Token Authentication, a token is generated using the user's credentials and included in every authenticated request to the API. It is a good balance between simplicity and security. DRF supports token authentication out of the box.

### 1. Install Django Rest Framework

```bash
pip install djangorestframework
```

### 2. Update `settings.py`

```python
# Make DRF and its token authentication feature available for use
INSTALLED_APPS = [
    ...
    'rest_framework',
    'rest_framework.authtoken',
    ...
]

# Specify TokenAuthentication as a default authentication class
REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': [
        'rest_framework.authentication.TokenAuthentication',
    ],
}
```

### 3. Migrate the Database
Create the necessary database tables for token authentication.

```bash
python manage.py migrate
```

### 4. Add a URL Pattern for Your View

urls.py:
```py
from django.urls import path
from user import views

urlpatterns = [
    path('example/', views.ExampleView.as_view(), name='example'),
]
```

### 5. Create a View

Here's a example of a view that requires token authentication.

```python
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework.permissions import IsAuthenticated

class ExampleView(APIView):
    permission_classes = [IsAuthenticated]

    def get(self, request, format=None):
        content = {
            'message': 'Hello, World!'
        }
        return Response(content)
```

This view is accessible only to authenticated users. By utilizing the `IsAuthenticated` permission class, any request that isn't authenticated is automatically rejected, and an HTTP status code of `401 Unauthorized` is returned.


### 6. Test
For testing purposes, create a user and generate a token manually.

```bash
python manage.py shell
```

```python
from django.contrib.auth.models import User
from rest_framework.authtoken.models import Token

user = User.objects.create_user('username', 'email@example.com', 'password')
token = Token.objects.create(user=user)
print(token.key)
```

Then, make a request to the view with the authorization token.

```bash
curl -X GET http://localhost:8000/example/ -H 'Authorization: Token <TOKEN>'
```

## APIView vs Viewsets

A view handles requests to a specific URL.

- **API views** are focused around HTTP methods. They are suited for custom logic or non-CRUD operations, such as authentication endpoints, running background jobs or interacting with external APIs.

- **Viewsets** are focused around actions. They are optimized for CRUD operations on models, working seamlessly with routers, which automatically generate URLs based on the viewset's structure.


